<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Doctor Signup/Login</title>
  <link rel="stylesheet" href="css/signup.css">
  <link href="https://fonts.googleapis.com/css2?family=Jost:wght@500&display=swap" rel="stylesheet">
</head>
<body>
  <div class="main">
    <input type="checkbox" id="chk" aria-hidden="true">

    <div class="signup">
      <!-- doctor signup Form -->
      <form id="doctor-signup-form" method = "post">
        <label for="chk" aria-hidden="true">Sign up</label>
        <input type="text" name="name" placeholder="Doctor Name" required>
        <select name="gender" required>
          <option value="" disabled selected>Gender</option>
          <option value="male">Male</option>
          <option value="female">Female</option>
          <option value="other">Other</option>
        </select>
        <input type="text" name="department" placeholder="Field/Department" required>
        <input type="text" name="appointment" placeholder="Title" required>
        <input type="tel" name="contact" placeholder="Contact Number" required>
        <input type="email" name="email" placeholder="Email Address" required>
        <input type="password" name="password" placeholder="Password" required>
        <button type="submit">Sign up</button>
      </form>
    </div>


    <!-- doctor Login Form -->
    <div class="login">
      <form id="doctor-login-form" method = "post">
        <label for="chk" aria-hidden="true">Login</label>
        <input type="email" name="email" placeholder="Email" required>
        <input type="password" name="pswd" placeholder="Password" required>
        <button type="submit">Login</button>
      </form>
    </div>
  </div>
</body>



<script>
  // Doctor Signup Fetch
  document.getElementById('doctor-signup-form').addEventListener('submit', async function(e) {
    e.preventDefault();
    const form = e.target;
    const formData = {
      name: form.name.value,
      gender: form.gender.value,
      department: form.department.value,
      appointment: form.appointment.value,
      contact: form.contact.value,
      email: form.email.value,
      password: form.password.value
    };

    try {
      const res = await fetch("https://emergency-response-aeh2.onrender.com/api/signup/doctor/", {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'X-CSRFToken': getCookie('csrftoken')
        },
        body: JSON.stringify(formData)
      });
      const result = await res.json();
      alert(result.message || 'Doctor signup successful!');
    } catch (err) {
      alert('Signup failed: ' + err.message);
    }
  });

  // Login Fetch (same file)
  document.getElementById('doctor-login-form').addEventListener('submit', async function(e) {
    e.preventDefault();
    const form = e.target;
    const loginData = {
      email: form.email.value,
      password: form.pswd.value
    };

    try {
      const res = await fetch("https://emergency-response-aeh2.onrender.com/api/login/", {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'X-CSRFToken': getCookie('csrftoken')
        },
        body: JSON.stringify(loginData)
      });
      const result = await res.json();
      alert(result.message || 'Login successful!');
      // Redirect based on role if needed
      // window.location.href = '/doctor-profile.html';
    } catch (err) {
      alert('Login failed: ' + err.message);
    }
  });

  // CSRF helper
  function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
      for (const cookie of document.cookie.split(';')) {
        const [key, value] = cookie.trim().split('=');
        if (key === name) {
          cookieValue = decodeURIComponent(value);
          break;
        }
      }
    }
    return cookieValue;
  }
</script>







  
<!--conecting HTML forms with javascript
<script>
  const signupForm = document.querySelector('.signup form');
  signupForm.addEventListener('submit', async (e) => {
    e.preventDefault();

    const formData = new FormData(signupForm);
    const data = Object.fromEntries(formData.entries());

    const response = await fetch('/api/signup/doctor/', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data),
    });

    const result = await response.json();
    alert(result.message);
    if (response.ok) {
      window.location.href = 'doctor-profile.html'; // simulate redirect
    }
  });
</script>
-->

</html>
